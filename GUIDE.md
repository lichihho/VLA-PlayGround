# VLA PlayGround — 視覺景觀研究遊樂園

歡迎來到 VLA PlayGround（Visual Landscape Analysis PlayGround）！

這是一個整合了 AI 景觀影像分析工具的互動式研究環境。你可以直接用自然語言請 Claude 幫你分析景觀照片、管理 NAS 上的資料集、建立研究專案並儲存分析結果，不需要寫任何程式碼。

---

## 環境裡有什麼？

本環境連接了三個 AI 服務，部署在區域網路的伺服器上：

### 1. LaDeco — 景觀影像語意分割

基於 OneFormer 模型（ADE20K 資料集），能將景觀照片中的每個像素分類，並計算各類別的面積比例。

**核心能力：**
- 分析單張或多張景觀影像的組成比例
- 批次處理整個資料集並產出 CSV
- 產生彩色語意分割圖（視覺化）
- 計算自然特徵指數（LC_NFI）

### 2. NAS File Server — 檔案管理

操作 NAS 儲存設備上的資料集檔案。

**核心能力：**
- 瀏覽、搜尋 NAS 上的資料集和檔案
- 讀取、寫入、複製、搬移、刪除檔案
- 查看檔案詳細資訊（大小、日期等）

### 3. pg-vector — 研究資料庫 + 向量搜尋

PostgreSQL + pgvector 資料庫，管理研究專案、影像中繼資料與分析結果，並支援以向量相似度搜尋相似影像。

**核心能力：**
- 建立研究專案，追蹤研究者與主題
- 註冊影像並儲存地理座標、檔案路徑等中繼資料
- 儲存分析結果（連結專案與影像），包含工具名稱、信心分數等
- 以 512 維向量進行相似影像搜尋（cosine similarity）

---

## 4 層標籤階層

LaDeco 使用自訂的 4 層階層標籤系統，從粗到細：

| 層級 | 說明 | 類別數 | 範例 |
|------|------|--------|------|
| **L1** | 自然 vs. 人造 | 2 | nature, man_made |
| **L2** | 主要類別 | 7 | 生物、地形、天空、植被、水體、建築、街道 |
| **L3** | 中等細分 | 16 | 草本植物、木本植物、水平水體、垂直水體… |
| **L4** | 精細類別 | ~50 | 樹、草、道路、建築物、汽車、河流… |

分析時預設使用 **L2**。你可以指定想看哪一層的結果。

---

## 你可以這樣問我

### 影像分析

> 「幫我分析這張照片的景觀組成」
>
> 「用 L3 層級分析 /mnt/ai_data/campus/photo01.jpg」
>
> 「這張照片的自然特徵指數是多少？」
>
> 「產生這張照片的語意分割圖讓我看看」

### 批次處理

> 「NAS 上有哪些資料集？」
>
> 「幫我預覽 campus_photos 資料集裡有什麼」
>
> 「批次分析 park_survey 資料集，用 L2 層級」

### 比較分析

> 「比較這兩張照片的綠覆率差異」
>
> 「這個資料集裡哪張照片的 LC_NFI 最高？」

### 檔案管理

> 「NAS 上的 datasets 資料夾裡有什麼？」
>
> 「搜尋 NAS 上所有 .jpg 檔案」
>
> 「把分析結果存到 NAS 上」

### 研究專案管理

> 「幫我建立一個新的研究專案，主題是校園綠覆率調查」
>
> 「列出所有研究專案」
>
> 「把這張照片的分析結果存進專案裡」
>
> 「這張影像有沒有相似的照片？」

### 了解系統

> 「L1 到 L4 分別有哪些類別？」
>
> 「顯示 L3 的色彩圖例」
>
> 「解釋一下 LC_NFI 是什麼」

---

## 實用工作流程

### 工作流程 1：快速分析一張照片

1. 告訴我照片路徑（NAS 上的路徑，或上傳照片）
2. 我會回傳各類別的面積比例與 LC_NFI
3. 需要的話，我可以產生分割圖讓你看

### 工作流程 2：批次分析整個資料集

1. 先用 `list_datasets` 查看有哪些資料集
2. 選定資料集後進行批次分析
3. 結果會存成 CSV 檔，可供下載

### 工作流程 3：資料集管理

1. 用 NAS File Server 瀏覽現有資料集
2. 整理檔案（搬移、複製、重命名）
3. 上傳新影像到指定資料集目錄

### 工作流程 4：研究專案全流程

1. 建立研究專案（指定研究者、主題）
2. 註冊影像到資料庫（含座標、NAS 路徑）
3. 用 LaDeco 分析影像，結果自動存入專案
4. 以向量搜尋找出相似影像，進行比較分析
5. 查看專案摘要（影像數、分析數、使用工具）

---

## 技術細節

| 項目 | 說明 |
|------|------|
| 模型 | OneFormer (Swin-L, ADE20K) |
| 分類數 | ADE20K 150 類 → LaDeco 4 層階層 |
| 指標 | LC_NFI（自然特徵指數）= 自然面積比例 |
| 服務位址 | LaDeco `192.168.1.162:30800`、NAS `192.168.1.162:30803`、pg-vector `192.168.1.152:30805` |
| REST API 文件 | Swagger UI (`/api/docs`) 或 `docs/services/` 下的服務文件 |

---

## 詳細文件

想深入了解各服務架構、REST API 端點、部署流程等細節，可參考 `docs/` 目錄：

| 文件 | 內容 |
|------|------|
| `docs/services/ladeco.md` | LaDeco 架構、REST API Reference、部署步驟 |
| `docs/services/nas-files.md` | NAS File Server 架構、REST API Reference、部署步驟 |
| `docs/services/pg-vector.md` | pg-vector 架構、Schema、REST API Reference、部署步驟 |
| `docs/infrastructure.md` | 基礎設施總覽（主機 IP、K8s、GitLab CI/CD） |

你可以直接請 Claude 讀取這些文件，例如：

> 「幫我看一下 LaDeco 的 REST API 文件」
>
> 「K8s 叢集的 IP 是什麼？」

---

## 參考文獻

Li-Chih Ho (2023). *LaDeco: A Tool to Analyze Visual Landscape Elements*. Ecological Informatics, vol. 78.
